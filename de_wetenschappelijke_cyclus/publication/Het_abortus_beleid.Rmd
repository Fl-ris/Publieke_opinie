---
title: Invloed van leeftijd, geslacht en opleidingsniveau op abortus gerelateerde ideologische verschillen in mening.  # Geef je paper een naam die prikkelt, informatief is, en zo kort mogelijk

author: |
  | Iris Ineke $^1$, Jasper Jonker $^1$, Floris Menninga $^1$
  | $^1$Hanzehogeschool

lang: nl # dit zorgt er voor dat "abstract" "samenvatting" gaat heten

abstract: |
  To-do: Bibliografie maken (template invullen), thema gelijk maken (theme_minimal()) en aan het eind de abstract schrijven, dit moet een samenvatting zijn van alles dat bersproken is. 
    

bibliography: Het_abortus_beleid.bib # naam van je .bib file. Deze moet hetzelfde zijn als je Rmd bestandsnaam

output:
  bookdown::pdf_document2:
    keep_tex: false    # set this to true if you want to investigate the generated tex
    toc: false         # table of contents
    fig_caption: true  # includes figure captions with numbering in output
    includes:  
        in_header: include_tex_header.tex #will include rules for linespacing and figure floating

---


```{r setup, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(out.width = '100%', dpi=300) # configuratie voor figuur grootte en resolutie
knitr::opts_chunk$set(echo = FALSE) # Deze regel zorgt ervoor GEEN ENKELE chunk getoond wordt! 
knitr::opts_chunk$set(digits = 2)
# Laad alle gebruikte bibliotheken hier
library(ggplot2)
```

```{r message=FALSE, warning=FALSE}
# Libraries
library(ggraph)
library(tidyverse)
library(viridis)
library(ggplot2)
library(dplyr) 
library(rgexf)
library(ggrepel)
library(ggridges)


library("ggpubr")
# Voor statistische analyses:
library("pwr")

#Laad dataset:
abortus <- read.csv("../analysis/abortus_dataset.csv", na.strings = "NA")


# voor de vraag: Vindt u dat iemand zelf moet kunnen kiezen of die een abortus wil?
abortus$eigen_keuze_abortus <- factor(x = abortus$Vindt.u.dat.iemand.zelf.moet.kunnen.kiezen.of.die.een.abortus.wil.,  
                           levels = c("Ja", "Nee"),
                           labels = c("Wel abortus toestaan", "Geen abortus toestaan"))

# Voor de vraag: Wat is uw religieuze overtuiging?
abortus$geloof <- factor(x = abortus$Wat.is.uw.religieuze.overtuiging.., 
                           levels = c("Christendom ", "Islam", "Hindoeïsme", "Boeddhisme", "Niet gelovig", "Anders"),
                           labels = c("Christendom", "Islam", "Hindoeïsme", "Boeddhisme", "Niet gelovig", "Anders"))


abortus$geslacht <- factor(x = abortus$Wat.is.uw.geslacht..,
                           levels = c("Man", "Vrouw", "Wil ik liever niet melden"),
                           labels = c("Man", "Vrouw", "Wil ik liever niet melden"))
# Voor de vraag: Wat is uw religieuze overtuiging?

abortus$afkomst <- factor(x = abortus$In.welke.provincie.heeft.u.het.grootste.deel.van.uw.jeugd.doorgebracht., 
                           levels = c("Drenthe", "Flevoland", "Friesland", "Gelderland", "Groningen", "Limburg", "Noord-Brabant", "Noord-Holland", "Overijssel", "Utrecht", "Zeeland", "Zuid-Holland", "Ik ben niet in Nederland opgegroeid"),
                           labels = c("Drenthe", "Flevoland", "Friesland", "Gelderland", "Groningen", "Limburg", "Noord-Brabant", "Noord-Holland", "Overijssel", "Utrecht", "Zeeland", "Zuid-Holland", "Buitenland"))


abortus$onderwijsniveau <- factor(x =
                                abortus$Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond.,
                                  levels = c("Geen diploma ", "Middelbare school", "MBO", "HBO", "Universiteit","Overige"),
                                  labels = c("Geen diploma", "Middelbare school", "MBO", "HBO", "Universiteit","Overige"))



# Voor de vraag: Indien u bij de vorige vraag nee heeft ingevuld...
abortus$als_nee <- factor(x = 
                        abortus$Indien.u.bij.de.vorige.vraag..Nee..heeft.ingevuld...Vindt.u.dat.er.uitzonderingen.zijn.waarin.iemand.dit.wel.zelf.moet.kunnen.kiezen.....,
                          levels = c("Ja", "Nee", "Niet van toepassing"),
                          labels = c("Ja", "Nee", "Niet van toepassing"))

abortus.test <- data.frame(abortus$geloof)

abortus$gezondheid_vrouw <- factor(x = abortus$Vindt.u.dat.er.voor.abortus.gekozen.mag.worden.als.de.gezondheid.van.de.vrouw.door.de.zwangerschap.in.gevaar.kan.komen.,
                                   levels = c("Ja", "Nee", "Weet ik niet"),
                                   labels = c("Ja", "Nee", "Weet ik niet"))


abortus$gevolg <- factor(x = abortus$De.zwangerschap.veroorzaakt.is.door.verkrachting,
                         levels = c("Ja", "Nee"),
                         labels = c("Ja", "Nee"))

abortus$minderjarig <- factor(x = abortus$Vindt.u.dat.een.minderjarig.kind.de.keuze.moet.hebben.om.voor.een.abortus.te.kiezen.....,
                              levels = c("Ja", "Nee", "Weet ik niet"),
                              labels = c("Ja", "Nee", "Weet ik niet"))

abortus$ouders <- factor(x = abortus$Vindt.u.dat.de.ouders.zeggenschap.moeten.hebben.over.of.hun.minderjarige.kind.wel.of.niet.voor.abortus.mag.kiezen...,
                         levels = c("Ja", "Nee", "Weet ik niet"),
                         labels = c("Ja", "Nee", "Weet ik niet"))

abortus$echo <- factor(x = abortus$Moet.het.wettelijk.verplicht.worden.voor.vrouwen.die.een.abortus.willen.om.een.echo.van.de.foetus.te.zien.voordat.een.abortus.toegestaan.is.,
                       levels = c("Ja", "Nee", "Weet ik niet"),
                       labels = c("Ja", "Nee", "Weet ik niet"))

abortus$bedenktijd <- factor(x = abortus$Vindt.u.dat.de.wettelijke.bedenktijd.moet.terugkomen.,
                             levels = c("Ja", "Nee", "Weet ik niet"),
                             labels = c("Ja", "Nee", "Weet ik niet"))
                             
abortus$adoptie <- factor(x = abortus$Vindt.u.dat.adoptie.een.alternatief.is.voor.abortus.,
                          levels = c("Ja", "Nee", "Weet ik niet"),
                          labels = c("Ja", "Nee", "Weet ik niet"))

abortus$vader <- factor(x = 
                          abortus$Moet.de.biologische.vader.zeggenschap.hebben.over.de.beslissing.voor.een.abortus.,
                            levels = c("Ja", "Nee", "Weet ik niet"),
                            labels = c("Ja", "Nee", "Weet ik niet"))

# Vragen met een volgorde: 
# namen van de variabelen eidigen met "_o" om aan te duiden dat er een volgorde in zit (order)

abortus$levensgevaar_vrouw_o <- factor(x = abortus$Het.leven.van.de.vrouw.in.gevaar.is,
                                     levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                     labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                     order = TRUE)

abortus$geestelijke_handicap_o <- factor(x = abortus$Het.kind.met.een.geestelijke.handicap.geboren.kan.worden,
                                         levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         order = TRUE)
abortus$levensbedreigende_ziekte_o <- factor(x = abortus$Het.kind.met.een.levensbedreigende.ziekte.geboren.kan.worden,
                                             levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                             labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                             order = TRUE)

abortus$veroorzaakt_o <- factor(x = abortus$De.zwangerschap.veroorzaakt.is.door.verkrachting,
                                levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                order = TRUE)

abortus$niet_gespecificeerd_o <- factor(x = abortus$De.vrouw.het.kind.niet.wil.houden.om.niet.gespecificeerde.redenen,
                                        levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                        labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                        order = TRUE)


abortus$financiele_beperkingen <- factor(x = abortus$De.vrouw.niet.in.staat.is.voor.het.kind.te.zorgen.vanwege.financiële.beperkingen,
                                         levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         order =TRUE)
df <- data.frame(abortus)


```


```{r}
# Voor info over leeftijd:
df_test <- df %>% select(geslacht, Wat.is.uw.leeftijd.)

man_leeftijd <- (df_test[df_test$geslacht == 'Man',]$Wat.is.uw.leeftijd.)
vrouw_leeftijd <- (df_test[df_test$geslacht == 'Vrouw',]$Wat.is.uw.leeftijd.)


```


# Introductie

Vragen over het abortus beleid zijn polariserende ethische kwesties. In ons onderzoek trachten we correlaties te vinden tussen verschillende variabelen zoals: leeftijd, geslacht, opleidingsniveau, geloof en de ideologische verschillen in mening tussen deze mensen.  

In de literatuur was al bekend dat jongere mensen vaak geneigd zijn voorstanders te zijn van de keuzevrijheid om voor een abortus te kiezen en oudere mensen hier vaker tegen zijn. (bron: https://www.emerald.com/insight/content/doi/10.1108/01443339810788533/full/html), ook is er een positieve correlatie gevonden tussen hoogopgeleiden en de mening dat abortus een eigen keuze moet zijn. (bron: https://www.emerald.com/insight/content/doi/10.1108/01443339810788533/full/html)

In tegenstelling tot het verschil in mening tussen mannen en vrouwen over andere politieke vraagstukken (bron: https://doi.org/10.1093/sp/jxs005)
Is er, mits er rekening wordt gehouden met verschillen in religieuze overtuiging, het geslacht geen significant bijdragende factor is voor de beslissing om  voor- of tegenstander te zijn van abortus (bron:  https://doi.org/10.1111/pops.12803)
Ondanks dat deze kwestie vooral betrekking heeft op vrouwen is er nog meer bestaand onderzoek beschikbaar dat verder bevestigd dat er weinig verschil is tussen de meningen van de verschillende geslachten. (bron: https://link.springer.com/article/10.1023/a:1021427014047)

Deze bovenstaande onderzoeken zijn gebaseerd op data van Noorwegen en Amerika, voor dit onderzoek is de grote meerderheid van de data verkregen van Nederlandse inwoners die ook in Nederland zijn opgegroeid. 

Om de meningen van dit publiek te peilen met betrekking tot hun ethische normen en waarden is er een vragenlijst opgesteld met als doel om 
te achterhalen wat bijdragende factoren zijn die voor meningsverschillen kunnen zorgen, dit zijn bijvoorbeeld geloof en leeftijd. 

Deze data wordt vervolgens geanalyseerd met onder andere een logistische regressie om de invloed van meerdere factoren te zien op de uitkomst van elke enquête vraag. 



(De introductie moet tussen de 400-800 woorden bevatten.)


# Materialen en Methoden

Voor de enquete zijn er een aantal vragen opgesteld die een beeld moeten geven van de meningen van de mensen die hem invullen. 
Ook zijn er persoonlijke vragen die gebruikt worden om keuzes te correleren met factoren als: geloof, leeftijd, opleidingsnivea en geslacht.

Deze vragen zijn neutraal geformuleerd zodat de invuller niet onbewust geneigd is om voor de optie te kiezen waar de vraagstelling neigt te gaan. 
De vragen kunnen verdeeld worden in drie categorieën: Persoonlijke informatie, multiple-choice en op een een schaal van zeer oneens tot zeer eens.
 
De enquete bestaat uit de volgende vragen: \

**Persoonlijke vragen:** \
1. Wat is uw geslacht?
2. Wat is het hoogste onderwijsniveau dat u heeft afgerond?
3. Wat is uw leeftijd?
4. Wat is uw religieuze overtuiging?
5. In welke provincie heeft u het grootste deel van uw jeugd doorgebracht? \

**Multiple choice vragen:** \
1. Vindt u dat iemand zelf moet kunnen kiezen of die een abortus wil?
2. Indien u bij de vorige vraag 'Nee' heeft ingevuld; 
3. Vindt u dat er uitzonderingen zijn waarin iemand dit wel zelf moet kunnen kiezen?
4. Vindt u dat er voor abortus gekozen mag worden als de gezondheid van de vrouw door de zwangerschap in gevaar kan komen?

5. Vindt u dat iemand een abortus mag als de zwangerschap een gevolg is van verkrachting?
6. Vindt u dat een minderjarig kind de keuze moet hebben om voor een abortus te kiezen? 

9. Moet het wettelijk verplicht worden voor vrouwen die een abortus willen om een echo van de 10. foetus te zien voordat een abortus toegestaan is?
11. Vindt u dat de wettelijke bedenktijd moet terugkomen?

12. Vindt u dat adoptie een alternatief is voor abortus?
13. Moet de biologische vader zeggenschap hebben over de beslissing voor een abortus?

**Schaal zeer oneens tot zeer eens vragen:** \
1. Hoe goed kunt u zichzelf vinden in de volgende stellingen?

2. Het leven van de vrouw in gevaar is

3. Het kind met een geestelijke handicap geboren kan worden

4. Het kind met een levensbedreigende ziekte geboren kan worden

5. De zwangerschap veroorzaakt is door verkrachting

6. De vrouw het kind niet wil houden om niet gespecificeerde redenen

7. De vrouw niet in staat is voor het kind te zorgen vanwege financiële beperkingen


De vraag: Vindt u dat de wettelijke bedenktijd moet terugkomen? werd gesuplementeerd met de volgende informatie: 
Sinds 1 januari 2023 is de verplichte minimale bedenktijd van 5 dagen vervallen. Voorheen moesten er minimaal 5 dagen zitten tussen het gesprek met een arts en de abortus zelf. Op dit moment geldt een flexibele bedenktijd die wordt bepaalt door een gesprek tussen de vrouw die abortus wil en een arts. De arts bepaalt nu op basis van dit gesprek hoelang de bedenktijd moet zijn voor de vrouw. Dit kan 0 dagen zijn, maar ook 10.

En de vraag: Vindt u dat de ouders zeggenschap moeten hebben over of hun minderjarige kind wel of niet voor abortus mag kiezen? werd gesupplementeerd met de volgende informatie:
In de huidige situatie moet er toestemming zijn van de ouders, er zijn wel uitzonderingen. Nu mag je onder de 15 abortus te plegen met toestemming van de ouders.   

Deze vragen zijn neutraal geformuleerd zodat de invuller niet onbewust geneigd is om voor de optie te kiezen waar de vraagstelling neigt te gaan. 
Microsoft Forms is gebruikt om een enquete te maken die deze bovenstaande vragen bevat. 


**Het verspreiden van de enquete:**
De weblink die verkregen was van Microsoft Forms, is middels digitale communicatie programma's zoals: E-mail, whatsapp, discord etc. verspreid. 

De makers van deze enquete hebben hem naar klasgenoten, familieleden en vrienden gestuurd met de instructie om hem door te sturen naar andere Familie, kennissen en vrienden. Op deze manier zijn er in totaal 114 correspondenten geweest die hem ingevuld hebben.

Deze sectie moet tussen de 400-800 woorden bevatten. (nu 568)

# Resultaten
De enquête is afgenomen door `r count(df %>% select(geslacht) %>% filter(geslacht == "Man"))` mannen en `r count(df %>% select(geslacht) %>% filter(geslacht == "Vrouw"))` vrouwen, dit zijn er `r max(df$ID)` mensen in totaal. De gemiddelde leeftijd is `r round(mean(df$Wat.is.uw.leeftijd.), digits=1)` jaar. De leeftijden van de mensen zijn niet normaal verdeeld, zoals zichtbaar op figuur 1 is de verdeling bimodaal.
Van de leeftijd van de mannen is de mediaan: `r summary(man_leeftijd)[3]`, het gemiddelde `r round(summary(man_leeftijd)[4], digits = 1)` en de standaard deviatie: `r round(sd(man_leeftijd), digits = 1)`.
Van de leeftijd van de vrouwen is de mediaan: `r summary(vrouw_leeftijd)[3]`, het gemiddelde `r round(summary(vrouw_leeftijd)[4], digits = 1)` en de standaard deviatie: `r round(sd(vrouw_leeftijd), digits = 1)`.
Er waren niet genoeg metingen (`r (count(df %>% select(geslacht) %>% filter(geslacht == "Wil ik liever niet melden")))` meting).


```{r warning=FALSE, fig.cap='Leeftijd van de mensen die de enquete ingevuld hebben geplot tegen geslacht' }


leeftijd_geslacht <- ggplot(df_test, aes(x= Wat.is.uw.leeftijd., y = geslacht)) +
  geom_boxplot(fill = "blue", alpha = 0.3, varwidth = T) +
  xlab("Leeftijd (Jaren)") +
  ylab("Geslacht") +
  theme_minimal()



#ggarrange(leeftijd_geslacht)
leeftijd_geslacht
```
Figuur ... weergeeft dit verschil tussen de leeftijden van de mannen, vrouwen en mensen die geen geslacht opgegeven hebben. 





```{r provictie verdeling, warning=FALSE, fig.cap='Verdeling van de afkomst van de mensen die de enquete ingevuld hebben.'}

# Maak tabel met aantal mensen per provincie.
x <- table(abortus$afkomst)
x <- sort(x, decreasing = T)
provincie_aantal <- data.frame(x)


# Reken de percentages uit: 
provincie_aantal$fraction = provincie_aantal$Freq / sum(provincie_aantal$Freq)
provincie_aantal$percentage = round(provincie_aantal$fraction *100, digits =1)
provincie_aantal$ymax = cumsum(provincie_aantal$fraction)
provincie_aantal$ymin = c(0, head(provincie_aantal$ymax, n=-1))
provincie_aantal$labelp = (provincie_aantal$ymax+provincie_aantal$ymin)/2
provincie_aantal$label = (paste(provincie_aantal$percentage, "% ", provincie_aantal$Var1))

# Verander de naam van de provincie colom van Var1 naar "provincies":
provincie_aantal <- provincie_aantal %>%
    rename(provincies = Var1)


# Maak het grafiekje:
ggplot(provincie_aantal,aes(ymax=ymax, ymin=ymin, xmax=13, xmin=3)) +
     geom_rect(color = "black",aes(fill=provincies)) +
     geom_label_repel(x = 13, aes(y=labelp, label= label), size=3, max.overlaps = 11, min.segment.length = 0) +
     coord_polar(theta="y") + 
     xlim(c(-13, 13)) +
     xlab(" ") +
     ylab(" ") +
     theme_void()


```



Op figuur 2 is weergeven dat de grootste fractie mensen die de enquete ingevuld hebben opgegroeid zijn in Gronigen, opgevolgd door Friesland en Drenthe.


```{r}
# Deze wel gebruiken?????!!?!?!?

# verdeling van de leeftijden:
leeftijd_dichtheid <- ggplot(df, aes(x= Wat.is.uw.leeftijd.)) +
  geom_histogram(aes(y = ..density..)) + 
  geom_density() +
  xlab("Leeftijd (Jaren)") +
  ylab("Dichtheid") +
  theme_minimal() 

# Grafiek met de verschillende geloven en de leeftijdverdeling die er bij hoort. 
geloof_leeftijd <- ggplot(df, aes(y= geloof,
               x= Wat.is.uw.leeftijd.)) +
  geom_boxplot(color = "black", fill = "blue", alpha = 0.3, varwidth=T) +
    xlab("Leeftijd (Jaren") +
    ylab("Geloof") +
    theme_minimal()


# Grafiek met leeftijden uit verschillende provincies.
afkomst_leeftijd <- ggplot(df, aes(y=afkomst,
               x= Wat.is.uw.leeftijd.)) +
  geom_boxplot(color = "black", fill = "blue", alpha = 0.3, varwidth = T) +
    xlab("Leeftijd (Jaren") +
    ylab("Op gegroeid in de provincie:") +
    theme_minimal()


ggarrange(afkomst_leeftijd, geloof_leeftijd)
```

Deze grafieken zijn nog niet klaar.... later nog aanpassen.


### Resultaten van de enquetevragen: ###

```{r, warning=FALSE, fig.cap='Vindt u dat adoptie een alternatief is voor abortus?'}
x1 <- table(df$adoptie)
adoptie_plot_data <- data.frame(x1)
adoptie_plot_data$fraction = adoptie_plot_data$Freq / sum(adoptie_plot_data$Freq)
adoptie_plot_data$percentage = round(adoptie_plot_data$fraction *100, digits =1)

#ggplot(data = df, mapping = aes(x = adoptie_plot_data, y = adoptie, fill = geslacht)) +
 ggplot(data = df, mapping = aes(x = ID, y = adoptie, fill = geslacht)) +
 geom_bar(stat = "identity") +
  geom_text(aes(label = (" "))) +
  xlab("Percentage mensen") +
  ylab(" ") +
  theme_minimal()

```


```{r vader plot, warning=FALSE, fig.cap='Moet de biologische vader zeggenschap hebben over de beslissing voor een abortus?'}
#Vindt u dat er voor abortus gekozen mag worden als de gezondheid van de vrouw door de zwangerschap in gevaar kan komen?
ggplot(data = df, mapping = aes(x = ID, y = vader, fill = geslacht)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = (" "))) +
  xlab("Percentage mensen") + # nog aapassen naar procent.
  ylab(" ") +
  theme_minimal()

```




```{r gezondheid plot, warning=FALSE, fig.cap='Antwoorden op de vraag:Vindt u dat er voor abortusgekozen mag worden als de gezondheid van de vrouw door de zwangerschap in gevaar kan komen?'}

ggplot(data = df, mapping = aes(x = ID, y = echo, fill = geslacht)) +
  geom_bar(stat = "identity") +
 # geom_text(aes(label = ("percentage hier"))) +
#  coord_flip() +
  ylab(" ") +
  xlab("Percentage mensen") +
  theme_minimal()
```
```{r bedenktijd plot, warning=FALSE, fig.cap='Antwoorden op de vraag: Vindt u dat de wettelijke bedenktijd moet terugkomen?'}


ggplot(data = df, mapping = aes(x = ID, y = bedenktijd, fill = geslacht)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = (" "))) +
   coord_flip() +
  xlab("Percentage mensen") + # nog aapassen naar procent.
  ylab(" ")

```


```{r echo plot, warning=FALSE, fig.cap='Antwoorden op de vraag:Vindt u dat er voor abortusgekozen mag worden als de gezondheid van de vrouw door de zwangerschap in gevaar kan komen?'}
ggplot(data = df, mapping = aes(x = c(1:114), y = levensgevaar_vrouw_o, fill = geslacht)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = (" "))) +
  labs(fill = "Geslacht") +
#  ggtitle("Vindt u dat er voor abortusgekozen mag worden als de gezondheid van \nde vrouw door de zwangerschap in gevaar kan komen?") +
  xlab("Percentage mensen") + # nog aapassen naar procent.
  ylab(" ") # Geen ylabel nodig omdat er al een beschrijving bij de waardes staan. 
  # labels beter maken.
  # To-do: prercentage verbeteren, huidige waarden kloppen nog niet.
```

### Schaal data (naam veranderen)

```{r abortus, warning=FALSE, fig.cap='Antwoorden op de vraag: Vindt u dat iemand een abortus mag als de zwangerschap een gevolg is van verkrachting?'}

ggplot(data = df, mapping = aes(x = (ID/100), y = veroorzaakt_o)) + # geeft procent weer. 
  geom_bar(stat = "identity",fill = "blue", alpha = 0.5) +
  facet_wrap(~geslacht) +
  ggtitle("Mag abortus als de zwangerschap\nresultaat is van verkrachting?") +
  xlab("Percentage mensen") + # verifiëren of dit wel klopt...
  ylab(" ") +
  theme_minimal()
```

```{r levensgevaar plot, warning=FALSE, fig.cap='Antwoorden op de vraag: Vindt u dat er voor abortus gekozen mag worden als de gezondheid van de vrouw door de zwangerschap in gevaar kan komen?'}

ggplot(data = df, mapping = aes(x = ID, y = levensgevaar_vrouw_o)) + # geeft procent weer. 
  geom_bar(stat = "identity", fill = "blue", alpha = 0.5) +
  facet_wrap(~geslacht) +
  xlab("Percentage mensen") +
  ylab(" ") +
  theme_minimal()

```

```{r, warning=FALSE, fig.cap='Antwoorden op de vraag: Moet de biologische vader zeggenschap hebben over de beslissing voor een abortus?, met onderwijsniveau en leeftijd.'}
ggplot(df, aes(x= Wat.is.uw.leeftijd., y = onderwijsniveau)) +
   geom_jitter(aes(color = vader, size = 2.5), alpha = 0.5, height = 0.05) +
 # geom_point(aes(color = vader, size = 2.5), alpha = 0.5) +
  facet_wrap(~geslacht) +
  labs(color = "Antwoord op vraag") +
  labs(" ") +
  xlab("Leeftijd (Jaren)") +
  ylab("Onderwijsniveau") +
  theme_minimal()

```



```{r chi-sq, warning=FALSE, fig.cap='P-waarde score voor de enquete vragen en het effect dat geslacht heeft op de keuze.'}

ja_abortus <- table(df$geslacht, df$eigen_keuze_abortus)
chi_ja_abortus <- chisq.test(ja_abortus, correct = T)

abortus_als_gevolg_van_01 <- table(df$geslacht, df$Vindt.u.dat.iemand.een.abortus.mag.als.de.zwangerschap.een.gevolg.is.van.verkrachting.)

# Chi-square test:
chi_abortus_als_gevolg_van <- chisq.test(abortus_als_gevolg_van_01, correct = T)

# Chi-square test:
chi_abortus_als_gevolg_van <- chisq.test(abortus_als_gevolg_van_01, correct = T)

abortus_minderjarig_keuze_01 <- table(df$geslacht, df$minderjarig)

# Chi-square test:
chi_abortus_minderjarig_keuze <- chisq.test(abortus_minderjarig_keuze_01, correct = T)

abortus_zeggenschap_ouders_01 <- table(df$geslacht, df$ouders)
# Chi-square test:
chi_abortus_zeggenschap_ouders <- chisq.test(abortus_zeggenschap_ouders_01, correct = T)
#df_chi_geslacht_test <- data.frame(c(chi_ja_abortus[3],chi_abortus_als_gevolg_van[3]))
abortus_echo_01 <- table(df$geslacht, df$minderjarig)
# Chi-square test:
chi_abortus_echo <- chisq.test(abortus_echo_01, correct = T)
abortus_bedenktijd_01 <- table(df$geslacht, df$bedenktijd)
# Chi-square test:
chi_abortus_bedenktijd <- chisq.test(abortus_bedenktijd_01, correct = T)
abortus_adoptie_01 <- table(df$geslacht, df$adoptie)
# Chi-square test:
chi_abortus_adoptie <- chisq.test(abortus_adoptie_01, correct = T)

abortus_zeggenschap_vader_01 <- table(df$geslacht, df$vader)
# Chi-square test:
chi_abortus_zeggenschap_vader <- chisq.test(abortus_zeggenschap_vader_01, correct = T)

chi_test_vector_geslacht <- c(chi_ja_abortus[3],chi_abortus_als_gevolg_van[3],chi_abortus_minderjarig_keuze[3],chi_abortus_zeggenschap_ouders[3],chi_abortus_echo[3],chi_abortus_bedenktijd[3],chi_abortus_adoptie[3],chi_abortus_zeggenschap_vader[3])
abortus_als_gevolg_van_01 <- table(df$geslacht, df$Vindt.u.dat.iemand.een.abortus.mag.als.de.zwangerschap.een.gevolg.is.van.verkrachting.)


df_chi_geslacht <- (data.frame((chi_test_vector_geslacht)) %>% rename(
  `Abortus toestaan` = p.value,
  `Gevolg van verkrachtign` = p.value.1,
  `Minderjarig kind` = p.value.2,
  `Zeggenschap ouders` = p.value.3,
  `Echo bekijken` = p.value.4,
  `Bedenktijd invoeren` = p.value.5,
  `Adoptie als alternatief` = p.value.6,
  `Zeggenschap vader` = p.value.7
  ))

df_chi_geslacht %>% 
  pivot_longer(cols = c(1:8)) -> df_chi_geslacht


ggplot(data = df_chi_geslacht, mapping = aes(x = name , y = value)) +
  geom_bar(stat = "identity",, fill = "blue", alpha = 0.5) +
  geom_hline(yintercept=0.05, linetype="dashed", color = "red") +
  geom_label_repel(position = position_nudge_repel(y = -0.07),aes(label = round(value,digits = 3)) ) +
  ylab("P-waarde Chi-square test:") +
  xlab(" ") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.6)) 
  
```
Op figuur 3 zijn de p-waarden van enkele vragen vergeleken. Wanneer de waarde onder de rode lijn zit kan er met 95% waarschijnlijkheid gezegd worden dat, in dit geval, geslacht een significant bijdragende factor is. Bij de vraag: "Moet de biologische vader zeggenschap hebben over de beslissing voor een abortus?" was de p-waarde: 0.018. Voor de overige vragen speelt geslacht geen significante rol (p-waarde > 0.05).



# Logistische regressies:
Voor de enquêtevraag zijn een aantal logistische regressies uitgevoerd die leeftijd, geslacht, opleidingsniveau en geloof als "predictor" of onafhankelijke variabelen hebben. 

```{r logistische regressie, warning=FALSE, fig.cap='test'}
df <- df %>% 
  mutate(gelovig_01 = ifelse(df$geloof == "Niet gelovig", 0,1)) 

# Dataframe voor man: (voor vraag over vader zeggenschap)
df_man <- df %>% 
  select(geslacht, Wat.is.uw.leeftijd., gelovig_01, Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond., eigen_keuze_abortus, vader, bedenktijd, minderjarig, gezondheid_vrouw, ouders) %>% 
  filter(geslacht == "Man")

# Voor de kolom met 0,1 waarden voor de keuze zijn alle "Weet ik niet" antwoorden vervangen door 0 (test)
df_logistische_regressie <- df %>% 
  select(geslacht, Wat.is.uw.leeftijd., gelovig_01, Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond., eigen_keuze_abortus, vader, bedenktijd, minderjarig, gezondheid_vrouw, ouders, echo) %>%
  mutate(ouders = (ifelse(ouders == "Ja", 1, 0)), leeftijd_onder_30 = (ifelse(Wat.is.uw.leeftijd. <= 30, 1,0)))


# Logistische regressie met leeftijd, geloof, opleidingsniveau en geslacht als predictors
logistische_regressie <- glm(eigen_keuze_abortus ~ leeftijd_onder_30 + geslacht + gelovig_01 + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond.,  data = df_logistische_regressie, family = binomial)


lr_man_vrouw_vader <- glm(vader ~ leeftijd_onder_30 + geslacht + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond. + gelovig_01, data = df_logistische_regressie, family = binomial)


# Logistische regressie voor de vraag: Moeten minderjarig kind zeggenschap hebben over eigen abortus, met als predictors: leeftijd, geslacht, onderwijsniveau en geloof
lr_man_vrouw_zeggenschap_minderjarig <- glm(minderjarig ~ leeftijd_onder_30 + geslacht + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond. + gelovig_01, data = df_logistische_regressie, family = binomial)


# Logistische regressie voor de vraag: Moet er een echo van de foetus laten zien worden voor er voor abortus gekozen mag worden:
lr_man_vrouw_echo <- glm(echo ~ leeftijd_onder_30 + geslacht + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond. + gelovig_01, data = df_logistische_regressie, family = binomial)


# Bedenktijd:
lr_man_vrouw_bedenktijd <- glm(bedenktijd ~ leeftijd_onder_30 + geslacht + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond. + gelovig_01, data = df_logistische_regressie, family = binomial)

# Logistische regressie voor de vraag: Mag er voor abortus gekozen worden als de gezondheid van de vrouw in gevaar is?
lr_man_vrouw_gezondheid_vrouw <- glm(df_logistische_regressie$gezondheid_vrouw ~ leeftijd_onder_30 + geslacht + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond. + gelovig_01, data = df_logistische_regressie, family = binomial)

lr_man_vrouw_gezondheid_ouders <- glm(df_logistische_regressie$ouders ~ leeftijd_onder_30 + geslacht + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond. + gelovig_01, data = df_logistische_regressie, family = binomial)


```

## **nog verbeteren...:**
```{r odds ratio}
# Zodat het niet in wetenschappelijke notatie weergeven wordt als het onder de 999 is. 
options(scipen = 999)

# Laat de coefficienten zien:
coefficienten_van_lr_man_vrouw_vader <- coef(lr_man_vrouw_vader)

# Verander de coëfficiënten naar procentuele verandering:
odds_ratio_lr_man_vrouw_vader  <- ( 1 - (exp(coefficienten_van_lr_man_vrouw_vader))) * 100

odds_ratio_lr_man_vrouw_vader <- data.frame(odds_ratio_lr_man_vrouw_vader)
#odds_ratio_lr_man_vrouw_vader <- data.frame(odds_ratio_lr_man_vrouw_vader) %>% row.names(
 # aaa = `(Intercept)`
#  )
#rownames <- rownames(odds_ratio_lr_man_vrouw_vader) 

new_rownames <- c("Intercept", "Leeftijd", "Geslacht", 4:10)
rownames(odds_ratio_lr_man_vrouw_vader) <- new_rownames


#odds_ratio_lr_man_eigen_keuze_abortus

```

## Visualisatie van de logistische regressie: ##

```{r Visualizatie Lr vraag: Moet de vader zeggenschap hebben, warning=FALSE, fig.cap='Logistische regressie visualisatie voor de vraag: Moet de biologische vader zeggenschap hebben over de beslissing voor een abortus?'}
# Lr
lr_man_vader <- glm(vader ~ Wat.is.uw.leeftijd. + gelovig_01 + Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond., data = df_man, family = binomial)

# Maak nieuw dataframe met de waardes van de logistische regressie en de keuze die de mensen die bij deze waardes horen gemaakt hebben. 
lr_voorspelling_vader <- data.frame(lr_man_vader$fitted.values, df_man$vader)

lr_voorspelling_vader <- lr_voorspelling_vader[order(lr_voorspelling_vader$lr_man_vader.fitted.values, decreasing = F),]

lr_voorspelling_vader$rank <- 1:nrow(lr_voorspelling_vader)

ggplot(data = lr_voorspelling_vader, aes(x = rank, y = lr_man_vader.fitted.values)) +
  geom_point(aes(color=df_man$vader, size = df_man$Wat.is.uw.leeftijd., alpha = 0.8)) +
  labs(size = "Leeftijd", color = "Antwoord op vraag") + 
  xlab("Index") +
  ylab("Waarschijnlijkheid (tussen 0 en 1)") +
  theme_minimal()
```
Op figuur .... zijn de met de logistische regressie berekende waarden laten zien voor elk persoon dat de vragen ingevuld heeft samen met de keuze die dit persoon gemaakt heeft (Ja/Nee/Weet ik niet). De uitkomst van deze logistische regressie is dat 
```{r}
#(summary(lr_man_vrouw_echo)) # Geloof significant
```


# Discussie en Conclusies

Deze sectie bevat tussen de 400-800 woorden.


# Online bijlagen

## Wordcount

Voeg aan het eind een woord-telling in:

```{r wordcount, message=FALSE}
#install.packages(devtools)
#devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE)
wordcountaddin:::text_stats()
```

# Referenties

Een lijst van referenties wordt hier automagisch toegevoegd.
