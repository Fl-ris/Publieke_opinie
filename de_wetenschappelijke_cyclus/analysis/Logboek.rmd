---
title: 'Logboek: Publieke Opinie'
author: "Floris Menninga"
date: "2024-04-22"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Libraries
library(data.tree)
library(ggraph)
library(igraph)
library(tidyverse)
library(viridis)
library(ggplot2)
library(dplyr) 
library(rgexf)

# Voor statistische analyses:
library("pwr")



```

## **De enquete** ##

Om de meningen van het publiek te peilen met betrekking tot hun ethische normen en waarden is er een vragenlijst opgesteld 
die de volgende vragen en stellingen bevat:

<hr>
#### Persoonlijke vragen: ####

Wat is uw geslacht? 

Man, Vrouw, Anders, Zeg ik liever niet. 

Wat is uw leeftijd? (Jaar) 


Bent u gelovig? (Ja/nee) 

Zo ja welke geloof? 
	Christendom, Islam, Hindoeïsme, Boeddhisme, jodendom, anders: ___ 

Waar bent u geboren? (Land) 


In Nederland? --> welke provincie? 

		 
<hr>
#### Inhoudelijke vragen: #### 

1. Vindt u dat iemand zelf moet kunnen kiezen of die een abortus wil? 

1.5 Zo nee, zijn er situaties waarin dit wel het geval moet zijn? 

2. Moet een kind (onder 18) de keuze hebben om een abortus te krijgen? 

2.5 Moeten ouders zeggenschap hebben over of hun kind wel of niet abortus mogen plegen. 

https://fiom.nl/ongewenst-zwanger/abortus/wet-regelgeving-abortus  

 
3.  Is adoptie een alternatief voor abortus?                 

4. Moet de bedenktijd terugkomen? 

 5.. Vindt u dat er abortus gepleegd mag worden als de gezondheid van de vrouw door de zwangerschap in gevaar kan komen? 

6. Vindt u dat er abortus gepleegd mag worden als de zwangerschap een gevolg is van verkrachting? 

7. Moet het wettelijk verplicht voor vrouwen die een abortus willen om een echo van de foetus te zien voor een abortus toegestaan is? 

8. Moet de vader zeggenschap hebben over de beslissing om een abortus te induceren? 

 

Hoe goed kan u uzelf vinden in de volgende stellingen (op een schaal van 0 tot 10) 

Een abortus is wenselijk wanneer: 

    Het leven van de vrouw in gevaar is: (0 tot 10) 

    Het kind met een geestelijke handicap (zoals het syndroom van Down) geboren zou worden. (0 tot 10) 

    Het kind met een levensbedreigende ziekte geboren zou worden. (0 tot 10) 

    De zwangerschap veroorzaakt was door verkrachting. (0 tot 10) 

    De vrouw het kind niet wil hebben voor niet gespecificeerde redenen.  
    
Enkele vragen hiervan zijn afgeleid van het volgende document: https://news.gallup.com/poll/1576/abortion.aspx

De enquête is vervolgens in Microsoft Forms gemaakt met de bovenstaande vragen. 
 

## **Automatisch gegenereerde testdata** ##

Voordat de data van de enquete verzameld was hebben we testdata gemaakt met behulp van R.
Dit heeft als doel om te oefenen met de gebruikte statistische analyse methoden die ook gebruikt gaan worden voor echte data. 


<hr>


De data verwerken:
Huidige working directory: `r getwd()`

```{r }
abortus <- read.csv("abortus_dataset.csv",
                    na.strings = "NA")
head(abortus)
```

```{r}
summary(abortus)
#str(abortus)
```

```{r echo=FALSE}

df_leeftijd <- data.frame(abortus$Wat.is.uw.leeftijd.) 

# verdeling van de leeftijden:
ggplot(df_leeftijd, aes(x= abortus$Wat.is.uw.leeftijd.)) +
  geom_density() +
  xlab("Leeftijd (Jaren)") 


```

## Omzetten naar factoren
In het onderstaande blok code worden factoren gemaakt van de meerkeuze vragen.


```{r}

#table(abortus$Vindt.u.dat.iemand.zelf.moet.kunnen.kiezen.of.die.een.abortus.wil., useNA = "always")



# voor de vraag: Vindt u dat iemand zelf moet kunnen kiezen of die een abortus wil?
abortus$eigen_keuze_abortus <- factor(x = abortus$Vindt.u.dat.iemand.zelf.moet.kunnen.kiezen.of.die.een.abortus.wil.,  
                           levels = c("Ja", "Nee"),
                           labels = c("Wel abortus toestaan", "Geen abortus toestaan"))

# Voor de vraag: Wat is uw religieuze overtuiging?
abortus$geloof <- factor(x = abortus$Wat.is.uw.religieuze.overtuiging.., 
                           levels = c("Christendom", "Islam", "Hindoeïsme", "Boeddhisme", "Niet gelovig", "Anders"),
                           labels = c("Christendom", "Islam", "Hindoeïsme", "Boeddhisme", "Niet gelovig", "Anders"))


abortus$geslacht <- factor(x = abortus$Wat.is.uw.geslacht..,
                           levels = c("Man", "Vrouw", "Wil ik liever niet melden"),
                           labels = c("Man", "Vrouw", "Wil ik liever niet melden"))
# Voor de vraag: Wat is uw religieuze overtuiging?

abortus$afkomst <- factor(x = abortus$In.welke.provincie.heeft.u.het.grootste.deel.van.uw.jeugd.doorgebracht., 
                           levels = c("Drenthe", "Flevoland", "Friesland", "Gelderland", "Groningen", "Limburg", "Noord-Brabant", "Noord-Holland", "Overijssel", "Utrecht", "Zeeland", "Zuid-Holland", "Ik ben niet in Nederland opgegroeid"),
                           labels = c("Drenthe", "Flevoland", "Friesland", "Gelderland", "Groningen", "Limburg", "Noord-Brabant", "Noord-Holland", "Overijssel", "Utrecht", "Zeeland", "Zuid-Holland", "Buitenland"))



abortus$onderwijsniveau <- factor(x =
                                abortus$Wat.is.het.hoogste.onderwijsniveau.dat.u.heeft.afgerond.,
                                  levels = c("Geen diploma", "Middelbare school", "MBO", "HBO", "Universiteit","Overige"),
                                  labels = c("Geen diploma", "Middelbare school", "MBO", "HBO", "Universiteit","Overige"))



# Voor de vraag: Indien u bij de vorige vraag nee heeft ingevuld...
abortus$als_nee <- factor(x = 
                        abortus$Indien.u.bij.de.vorige.vraag..Nee..heeft.ingevuld...Vindt.u.dat.er.uitzonderingen.zijn.waarin.iemand.dit.wel.zelf.moet.kunnen.kiezen.....,
                          levels = c("Ja", "Nee", "Niet van toepassing"),
                          labels = c("Ja", "Nee", "Niet van toepassing"))

abortus.test <- data.frame(abortus$geloof)

abortus$gezondheid_vrouw <- factor(x = abortus$Vindt.u.dat.er.voor.abortus.gekozen.mag.worden.als.de.gezondheid.van.de.vrouw.door.de.zwangerschap.in.gevaar.kan.komen.,
                                   levels = c("Ja", "Nee", "Weet ik niet"),
                                   labels = c("Ja", "Nee", "Weet ik niet"))


abortus$gevolg <- factor(x = abortus$De.zwangerschap.veroorzaakt.is.door.verkrachting,
                         levels = c("Ja", "Nee"),
                         labels = c("Ja", "Nee"))

abortus$minderjarig <- factor(x = abortus$Vindt.u.dat.een.minderjarig.kind.de.keuze.moet.hebben.om.voor.een.abortus.te.kiezen.....,
                              levels = c("Ja", "Nee", "Weet ik niet"),
                              labels = c("Ja", "Nee", "Weet ik niet"))

abortus$ouders <- factor(x = abortus$Vindt.u.dat.de.ouders.zeggenschap.moeten.hebben.over.of.hun.minderjarige.kind.wel.of.niet.voor.abortus.mag.kiezen...,
                         levels = c("Ja", "Nee", "Weet ik niet"),
                         labels = c("Ja", "Nee", "Weet ik niet"))

abortus$echo <- factor(x = abortus$Moet.het.wettelijk.verplicht.worden.voor.vrouwen.die.een.abortus.willen.om.een.echo.van.de.foetus.te.zien.voordat.een.abortus.toegestaan.is.,
                       levels = c("Ja", "Nee", "Weet ik niet"),
                       labels = c("Ja", "Nee", "Weet ik niet"))

abortus$bedenktijd <- factor(x = abortus$Vindt.u.dat.de.wettelijke.bedenktijd.moet.terugkomen.,
                             levels = c("Ja", "Nee", "Weet ik niet"),
                             labels = c("Ja", "Nee", "Weet ik niet"))
                             
abortus$adoptie <- factor(x = abortus$Vindt.u.dat.adoptie.een.alternatief.is.voor.abortus.,
                          levels = c("Ja", "Nee", "Weet ik niet"),
                          labels = c("Ja", "Nee", "Weet ik niet"))

abortus$vader <- factor(x = 
                          abortus$Moet.de.biologische.vader.zeggenschap.hebben.over.de.beslissing.voor.een.abortus.,
                            levels = c("Ja", "Nee"),
                            labels = c("Ja", "Nee"))

# Vragen met een volgorde: 
# namen van de variabelen eidigen met "_o" om aan te duiden dat er een volgorde in zit (order)

abortus$levensgevaar_vrouw_o <- factor(x = abortus$Het.leven.van.de.vrouw.in.gevaar.is,
                                     levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                     labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                     order = TRUE)

abortus$geestelijke_handicap_o <- factor(x = abortus$Het.kind.met.een.geestelijke.handicap.geboren.kan.worden,
                                         levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         order = TRUE)
abortus$levensbedreigende_ziekte_o <- factor(x = abortus$Het.kind.met.een.levensbedreigende.ziekte.geboren.kan.worden,
                                             levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                             labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                             order = TRUE)

abortus$veroorzaakt_o <- factor(x = abortus$De.zwangerschap.veroorzaakt.is.door.verkrachting,
                                levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                order = TRUE)

abortus$niet_gespecificeerd_o <- factor(x = abortus$De.vrouw.het.kind.niet.wil.houden.om.niet.gespecificeerde.redenen,
                                        levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                        labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                        order = TRUE)


abortus$financiele_beperkingen <- factor(x = abortus$De.vrouw.niet.in.staat.is.voor.het.kind.te.zorgen.vanwege.financiële.beperkingen,
                                         levels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         labels = c("zeer oneens", "oneens", "beetje oneens", "neutraal", "beetje eens", "eens", "zeer eens"),
                                         order =TRUE)

table(abortus$eigen_keuze_abortus, useNA = "always") # voor de vraag: Vindt u dat iemand zelf moet kunnen kiezen of die een abortus wil?





df <- data.frame(abortus)

#ggplot(df, aes(x=, y=abortus$Wat.is.uw.leeftijd.)) +
 # geom_bar(stat="identity", color="blue", fill="white")

```



```{r echo=TRUE}

# Grafiek met de verschillende geloven en de leeftijdverdeling die er bij hoort. 
ggplot(df, aes(y=abortus$geloof,
               x= abortus$Wat.is.uw.leeftijd.)) +
  geom_boxplot(color = "black", fill = "gold") +
    xlab("Leeftijd (Jaren") +
    ylab("Geloof")

```
Verdeling van de leeftijd van de mensen die de enquete hebben ingevuld en hun ideologie. 


```{r}

# Grafiek met leeftijden uit verschillende provincies.
ggplot(df, aes(y=abortus$afkomst,
               x= abortus$Wat.is.uw.leeftijd.)) +
  geom_boxplot(color = "black", fill = "gold") +
    xlab("Leeftijd (Jaren") +
    ylab("Op gegroeid in de provincie:")



```
De verdeling van de leeftijden en de provincies waar deze mensen vandaan komen wordt weergegeven op deze grafiek. 
Niet elke provincie heeft genoeg datapunten om een boxplot van te maken. 


```{r}

# De invultijd per leeftijd:

# Repareren: as.POSIXct functie werkt niet meer voor deze data.

begin_tijd <- as.POSIXct(x = (c(abortus$Begintijd)), format = "%m-%d-%y %H:%M:%S")  # startpunt van invullen per persoon.

# 
eind_tijd <- as.POSIXct(x = (c(abortus$Tijd.van.voltooien)), format = "%m-%d-%y %H:%M:%S") # eindpunt  van invullen per persoon.

tijd_vector <- c()
# Om de totale tijd uit te rekenen die de mensen nodig hadden om het formulier in te vullen.
# Het verschil tussen de eindtijd en de begintijd. 
for (x in seq_along(abortus$Begintijd)) {
  #print(paste0("Begin tijd: ", begin_tijd[x]))
  #print(paste0("eind tijd: ", eind_tijd[x])) 
  tijd_vector[x] <- as.numeric((eind_tijd[x] - begin_tijd[x]))
}

```


Op 11 mei 2024 grafiek gemaakt van leeftijd / tijd nodig om de enquete in te vullen. 
12-05-2024: Met facet_wrap() onderscheid gemaakt tussen mannen en vrouwen. (twee plots)


```{r}

tijd_vector <- data.frame(tijd_vector)

ggplot(tijd_vector, aes(y=tijd_vector,
                        x= abortus$Wat.is.uw.leeftijd.)) +
  geom_boxplot(aes(color = abortus$geslacht)) +
  facet_wrap(~abortus$geslacht) +
    xlab("Leeftijd (Jaren)") +
    ylab("Tijd om formulier in te vullen (minuten)") +
    coord_flip()

#summary(tijd_vector)
#head(tijd_vector)


```
Bovenstaande grafiek laat de relatie tussen leeftijd en tijdnodig om het formulier in te vullen zien. 
Dit wordt voor mannen en vrouwen gedaan. (links mannen, midden vrouwen en rechts ongespecificeerd.)
Er was maar een persoon dat ongespecificeerd opgav dus kan daar geen boxplot van gemaakt worden maar wordt dit weergeven met een enkele stip. (links onder in de grafiek)


```{r}

data_frame_invultijd <- data.frame(tijd_vector, abortus$geslacht, abortus$Wat.is.uw.leeftijd.)

# Voor de tijd die de mannen er over doen:
invultijd_mannen <- data_frame_invultijd %>%
  filter(abortus.geslacht == "Man")

# Voor de tijd die de vrouwen er over doen:
invultijd_vrouwen <- data_frame_invultijd %>%
  filter(abortus.geslacht == "Vrouw")

# Voor de tijd die de "ongespecificeerde geslacht" mensen er over doen:
invultijd_anders <- data_frame_invultijd %>%
  filter(abortus.geslacht == "Wil ik liever niet melden")



```
Gemiddeld doen de mannen er `r mean(invultijd_mannen$tijd_vector)` minuten over om de enquete in te vullen. <br>
Dit ligt tussen de `r quantile(invultijd_mannen$tijd_vector, 0.25)` (25%) en `r quantile(invultijd_mannen$tijd_vector, 0.75)` (75%)

Gemiddeld doen de vrouwen er `r mean(invultijd_vrouwen$tijd_vector)` minuten over om de enquete in te vullen. <br>
Dit ligt tussen de `r quantile(invultijd_vrouwen$tijd_vector, 0.25)` (25%) en `r quantile(invultijd_vrouwen$tijd_vector, 0.75)` (75%)

Gemiddeld doen de "Geslacht niet opgegeven mensen" er `r mean(invultijd_anders$tijd_vector)` minuten over om de enquete in te vullen. <br>
Dit ligt tussen de `r quantile(invultijd_anders$tijd_vector, 0.25)` (25%) en `r quantile(invultijd_anders$tijd_vector, 0.75)` (75%)

# Circulair Packing test 1: 
```{r eval=FALSE}



# Load dataset from github
data <- read.table("https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/11_SevCatOneNumNestedOneObsPerGroup.csv", header=T, sep=";")
data[ which(data$value==-1),"value"] <- 1
colnames(data) <- c("Continent", "Region", "Country", "Pop")

# Remove a few problematic lines
data <- data %>% filter(Continent!="") %>% droplevels()

# Change the format. This use the data.tree library. This library needs a column that looks like root/group/subgroup/..., so I build it
library(data.tree)
data$pathString <- paste("world", data$Continent, data$Region, data$Country, sep = "/")
population <- as.Node(data)
data <- data.frame(
  root=rep("root", 15),
  group=c(rep("group A",5), rep("group B",5), rep("group C",5)), 
  subgroup= rep(letters[1:5], each=3),
  subsubgroup=rep(letters[1:3], 5),
  value=sample(seq(1:15), 15)
)


# root = hele populatie
# group = geslacht
# subgroup = profintie
# value = de waarde van het punt wat we willen visualizeren. 


# Change the format. This use the data.tree library. This library needs a column that looks like root/group/subgroup/..., so I build it

data$pathString <- paste("world", data$group, data$subgroup, data$subsubgroup, sep = "/")
population <- as.Node(data)
population



#graph <- tbl_graph(flare$vertices, flare$edges)
set.seed(1)
ggraph(graph, 'circlepack', weight = size) + 
  geom_node_circle(aes(fill = depth), size = 0.25, n = 50) + 
  coord_fixed()

```
15-05-2024:
Om te achterhalen of de leeftijden van de mensen die de enquete ingevuld hebben normaal verdeeld zijn 
is de Shapiro Wilk test gebruikt. 
# Shapiro Wilk test:

```{r}


shapiro.test(abortus$Wat.is.uw.leeftijd.)
             
```
De p-waarde is: 2.097e-05 
dat betekend dat er wel een significant verschil is tussen een nomale verdeling en deze leeftijd data. 
Omdat de data niet normaal verdeeld is zal een niet-parametrische analyse nodig zijn. 

# Power analyse:

```{r}

#pwr.t.test(n = n, d = d, sig.level = alpha, type = "one.sample", alternative = "less")

```
# PIE CHART
```{r}

# Create Data
data <- data.frame(
  group=abortus$afkomst,
  value=abortus$afkomst
)

# Basic piechart
ggplot(data, aes(x="", y=value, fill=group)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)



```
```{r}
library(ggplot2)
# Create Data
data <- data.frame(
  group=abortus$afkomst,
  value=abortus$afkomst
)


# Basic piechart
ggplot(data, aes(x="", y=abortus$afkomst, fill=group)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  theme_void() + 
  theme(legend.position="none") 




```
```{r eval=FALSE}
df_1 <- data.frame(abortus)

ggplot(df_1, aes(x= c(1:109), y = vader)) +
  geom_point(aes(color = geslacht)) +
  labs(color = "test") +
  #scale_color_manual(name = "Cylinders") 
#  scale_fill_discrete(name = "test") +
  ggtitle("Moet de vader zeggenschap hebben over \nde beslissing om een abortus te induceren? ") 

  

```

```{r}


ggplot(df, aes(x= ID, y = onderwijsniveau)) +
  geom_point(aes(color = vader, size = abortus$geslacht)) +
  labs(color = "Keuze") +
  ggtitle("Moet de vader zeggenschap hebben over \nde beslissing om een abortus te induceren? ")


```


15-05-2024:
Bovenstaande grafiek: Moet de vader zeggenschap hebben over de abortus: Ja, Nee of geen mening.
Het geslacht van het persoon wordt met de twee kleuren blauw en rood aangegeven en de leeftijd met de grootte van het bolletje. (zie legenda voor schaalverdeling)

20-05-2024:

```{r}
# Voor vraag: Als u geen voorstander bent voor de vrijheid om voor een abortus te kiezen, zijn er gevallen waarin dit wel zou mogen?

ggplot(data = df, mapping = aes(x = (ID), y = als_nee)) +
  geom_bar(stat = "identity") +
  geom_point()

```
```{r}
# Voor de vraag: Vindt u dat er voor abortusgekozen mag worden als de gezondheid van de vrouw door de zwangerschap in gevaar kan komen? 
library(ggridges)
ggplot(data = df, mapping = aes(x = c(1:109), y = levensgevaar_vrouw_o, fill = geslacht)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = (" "))) +
  ggtitle("Vindt u dat er voor abortusgekozen mag worden als de gezondheid van \nde vrouw door de zwangerschap in gevaar kan komen?") +
  xlab("Percentage mensen") + # nog aapassen naar procent.
  ylab(" ") # Geen ylabel nodig omdat er al een beschrijving bij de waardes staan. 
  # labels beter maken.
```
```{r}
# Voor de vraag: Mag abortus toegestaan zijn als de zwangerschap resultaat is van verkrachting?

ggplot(data = df, mapping = aes(x = (ID/100), y = veroorzaakt_o, fill = gesla)) + # geeft procent weer. 
  geom_bar(stat = "identity") +
  ggtitle("Mag abortus als de zwangerschap resultaat is van verkrachting?") +
  xlab("Percentage mensen") + # verifiëren of dit wel klopt...
  ylab(" ")
```


## Cirkel packing grafiek test

```{r}
# Test 2:


edges <- data.frame(c("test", "test.test2", "test.test2.test3", "test0"))
vertices <- data.frame(c("1", "2", "3"), c("1", "2", "3"))

 
edgelist <- matrix(list(c("1","2","3"), c("1","2","3")),
                    byrow=TRUE, ncol=2)

edge.list(edgelist)

# We need a data frame giving a hierarchical structure. Let's consider the flare dataset:
#edges <- flare$edges
# Usually we associate another dataset that give information about each node of the dataset:
#vertices <- flare$vertices

# Then we have to make a 'graph' object using the igraph library:
mygraph <- graph_from_data_frame(edgelist)



# Test
hc <- df %>%
  dist %>%
  hclust

plot(hc)


# Make the plot
ggraph(hc, layout = 'circlepack') + 
  geom_node_circle() +
  theme_test()
```

```{r}
library(ggraph)
library(igraph)
library(tidyverse)
 
# We need a data frame giving a hierarchical structure. Let's consider the flare dataset:
edges <- flare$edges
#edges <- 
 
# Usually we associate another dataset that give information about each node of the dataset:
vertices <- flare$vertices
 
# Then we have to make a 'graph' object using the igraph library:
mygraph <- graph_from_data_frame( edges, vertices=vertices )
 
# Make the plot
ggraph(mygraph, layout = 'circlepack') + 
  geom_node_circle() +
  theme_void()
```

# Power test: (met leeftijd van de mensen)

17-05-2024:
Begin gemaakt met t.test en power test

```{r}
library(dplyr)
library(pwr)
tabel <- table(abortus$geslacht ,abortus$eigen_keuze_abortus) # tabel met mannen en vrouwen en hun keuze of abortus toegestaan moet worden of niet. 

#prop.table(abortus$Wat.is.uw.geslacht..)
tabel2 <- prop.table(tabel)

#gem_leeftijd_vrouwen %>%
# filter(abortus$Wat.is.uw.geslacht.., abortus$geslacht == "Vrouw")

ja_abortus <- (ifelse(abortus$eigen_keuze_abortus=="Wel abortus toestaan", 1,0)) # 1 voor de mensen de voorstander zijn, 0 als ze tegen zijn. 



#(res <- t.test(ja_abortus, mu = 52 , alternative = "two.sided") )

power <- pwr.p.test(h = 0.1, sig.level = 0.05, power = 0.8,alternative = "two.sided") # test, andere h uitrekenen.


```

# T-test:
>H0: Het geslacht van het persoon dat de enquete invult heeft geen invloed op hun keuze over het toestaan van de abortus.
>H1: Het geslacht van het persoon dat de enquete invult heeft invloed op hun keuze over het toestaan van de abortus.

```{r}
#onder21 <- filter(abortus$Wat.is.uw.leeftijd., abortus$Wat.is.uw.leeftijd. < 21)

#binaire_lijst_keuze_abortus <- 

ja_abortus <- (ifelse(abortus$eigen_keuze_abortus=="Wel abortus toestaan", 1,0)) # 1 voor de mensen de voorstander zijn, 0 als ze tegen zijn. 
#all(duplicated(abortus$geslacht)[-1L])

ja_nee_abortus <- t.test(ja_abortus, as.numeric(abortus$geslacht), data = abortus, alternative = "two.sided")

ja_nee_abortus
```
H0 is verworpen en H1 is aangenomen omdat de p-waarde `r ja_nee_abortus$p.value` is. Dit is onder de 0.05 en betekend dat met 95% zekerheid gezegd kan worden dat het geen toeval is dat er een verschil tussen de twee geslachten is en hun keuze om de abortus toe te staan of te verbieden. 

# Power Test:

<hr>


